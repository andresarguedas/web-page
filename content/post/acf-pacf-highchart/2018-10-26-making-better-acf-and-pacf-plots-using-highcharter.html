---
title: Making better ACF and PACF plots using highcharter
author: ''
date: '2018-10-26'
slug: acf-and-pacf-highcharter
categories:
  - R
tags:
  - R
  - highcharts
  - time series
  - interactive plots
image:
  caption: 'Test'
  focal_point: ''
---

<script src="/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="/rmarkdown-libs/pymjs/pym.v1.js"></script>
<script src="/rmarkdown-libs/widgetframe-binding/widgetframe.js"></script>


<pre class="r"><code>library(highcharter)
library(forecast)
library(astsa)
library(ggplot2)
library(strucchange)
library(grid)
library(gridExtra)
library(widgetframe)</code></pre>
<pre class="r"><code>frameWidget(hchart(acf(diff(AirPassengers), plot = FALSE)))</code></pre>
<div id="htmlwidget-1" style="width:100%;height:480px;" class="widgetframe html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"url":"/post/acf-pacf-highchart/2018-10-26-making-better-acf-and-pacf-plots-using-highcharter_files/figure-html//widgets/widget_acf highchart.html","options":{"xdomain":"*","allowfullscreen":false,"lazyload":false}},"evals":[],"jsHooks":[]}</script>
<p>And we can do the same with the partial correlation function</p>
<pre class="r"><code>frameWidget(hchart(pacf(diff(AirPassengers), plot = FALSE)))</code></pre>
<div id="htmlwidget-2" style="width:100%;height:480px;" class="widgetframe html-widget"></div>
<script type="application/json" data-for="htmlwidget-2">{"x":{"url":"/post/acf-pacf-highchart/2018-10-26-making-better-acf-and-pacf-plots-using-highcharter_files/figure-html//widgets/widget_pacf highchart.html","options":{"xdomain":"*","allowfullscreen":false,"lazyload":false}},"evals":[],"jsHooks":[]}</script>
<p>But there are somethings that just aren’t right about these plots. For example, the x-axis is off on the amount of lags, and, if we wanted to see both plots together, we wouldn’t be able to. So this is my solution:</p>
<pre class="r"><code>acf.ts &lt;- acf(diff(AirPassengers), plot = F)
pacf.ts &lt;- pacf(diff(AirPassengers), plot = F)
n &lt;- acf.ts$n.used
l &lt;- list()
l1 &lt;- list()

for(i in 1:nrow(acf.ts$acf)) {
  l[[i]] &lt;- list(x = i, y = acf.ts$acf[, , 1][i])
  l1[[i]] &lt;- list(x = i, y = pacf.ts$acf[, , 1][i])
}

frameWidget(highchart() %&gt;% 
  hc_title(text = &quot;Gráfico de autocorrelaciones&quot;) %&gt;% 
  hc_yAxis(title = list(text = &quot;ACF&quot;),
           plotLines = list(
             list(
               width = 1,
               value = qnorm((1 + 0.95) / 2) / sqrt(n),
               color = &quot;gray&quot;
           ), 
             list(
               width = 1,
               value = -qnorm((1 + 0.95) / 2) / sqrt(n),
               color = &quot;gray&quot;
             
           ))) %&gt;% 
  hc_xAxis(title = list(text = &quot;Rezagos&quot;)) %&gt;% 
  hc_yAxis_multiples(
    create_yaxis(2, height = c(1, 1))
  ) %&gt;% 
  hc_add_series(data = l,
            type = &quot;column&quot;,
            pointWidth = 2,
            name = &quot;ACF&quot;,
            yAxis = 0) %&gt;% 
  hc_add_series(data = l1,
            type = &quot;column&quot;,
            pointWidth = 2,
            name = &quot;PACF&quot;,
            yAxis = 1))</code></pre>
<div id="htmlwidget-3" style="width:100%;height:480px;" class="widgetframe html-widget"></div>
<script type="application/json" data-for="htmlwidget-3">{"x":{"url":"/post/acf-pacf-highchart/2018-10-26-making-better-acf-and-pacf-plots-using-highcharter_files/figure-html//widgets/widget_acf and pacf highchart.html","options":{"xdomain":"*","allowfullscreen":false,"lazyload":false}},"evals":[],"jsHooks":[]}</script>
<p>{{% alert warning %}} Here’s some important information… {{% /alert %}}</p>
<p>{{% alert note %}} Here’s a tip or note… {{% /alert %}}</p>
